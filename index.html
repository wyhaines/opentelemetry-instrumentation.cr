<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.5.0">
<meta name="crystal_docs.project_version" content="0.5.0">
<meta name="crystal_docs.project_name" content="opentelemetry-instrumentation">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="opentelemetry-instrumentation">
  <title>opentelemetry-instrumentation 0.5.0</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          opentelemetry-instrumentation
        </a>
      </h1>

      <span class="project-version">
        0.5.0
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="opentelemetry-instrumentation/Log" data-name="log">
      <a href="Log.html">Log</a>
      
    </li>
  
  <li class="parent " data-id="opentelemetry-instrumentation/OpenTelemetry" data-name="opentelemetry">
      <a href="OpenTelemetry.html">OpenTelemetry</a>
      
        <ul>
  
  <li class="parent " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation" data-name="opentelemetry::instrumentationdocumentation">
      <a href="OpenTelemetry/InstrumentationDocumentation.html">InstrumentationDocumentation</a>
      
        <ul>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalDB" data-name="opentelemetry::instrumentationdocumentation::crystaldb">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalDB.html">CrystalDB</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalGC" data-name="opentelemetry::instrumentationdocumentation::crystalgc">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalGC.html">CrystalGC</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalHttpClient" data-name="opentelemetry::instrumentationdocumentation::crystalhttpclient">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalHttpClient.html">CrystalHttpClient</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalHttpServer" data-name="opentelemetry::instrumentationdocumentation::crystalhttpserver">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalHttpServer.html">CrystalHttpServer</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalHttpWebSocket" data-name="opentelemetry::instrumentationdocumentation::crystalhttpwebsocket">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalHttpWebSocket.html">CrystalHttpWebSocket</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/CrystalLog" data-name="opentelemetry::instrumentationdocumentation::crystallog">
      <a href="OpenTelemetry/InstrumentationDocumentation/CrystalLog.html">CrystalLog</a>
      
    </li>
  
  <li class="parent " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/Framework" data-name="opentelemetry::instrumentationdocumentation::framework">
      <a href="OpenTelemetry/InstrumentationDocumentation/Framework.html">Framework</a>
      
        <ul>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/Framework/Lucky" data-name="opentelemetry::instrumentationdocumentation::framework::lucky">
      <a href="OpenTelemetry/InstrumentationDocumentation/Framework/Lucky.html">Lucky</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/Framework/SpiderGazelle" data-name="opentelemetry::instrumentationdocumentation::framework::spidergazelle">
      <a href="OpenTelemetry/InstrumentationDocumentation/Framework/SpiderGazelle.html">SpiderGazelle</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/JGaskinsRedis" data-name="opentelemetry::instrumentationdocumentation::jgaskinsredis">
      <a href="OpenTelemetry/InstrumentationDocumentation/JGaskinsRedis.html">JGaskinsRedis</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/RethinkDB" data-name="opentelemetry::instrumentationdocumentation::rethinkdb">
      <a href="OpenTelemetry/InstrumentationDocumentation/RethinkDB.html">RethinkDB</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/OpenTelemetry/InstrumentationDocumentation/StefanWilleRedis" data-name="opentelemetry::instrumentationdocumentation::stefanwilleredis">
      <a href="OpenTelemetry/InstrumentationDocumentation/StefanWilleRedis.html">StefanWilleRedis</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/String" data-name="string">
      <a href="String.html">String</a>
      
    </li>
  
  <li class=" " data-id="opentelemetry-instrumentation/TCPSocket" data-name="tcpsocket">
      <a href="TCPSocket.html">TCPSocket</a>
      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<p><img src="https://img.shields.io/github/workflow/status/wyhaines/opentelemetry-instrumentation.cr/OpenTelemetry%20Instrumentation%20CI?style=for-the-badge&amp;logo=GitHub" alt="OpenTelemetry CI" />
<a href="https://github.com/wyhaines/opentelemetry-instrumentation.cr/releases"><img src="https://img.shields.io/github/release/wyhaines/opentelemetry-instrumentation.cr.svg?style=for-the-badge" alt="GitHub release" /></a>
<img src="https://img.shields.io/github/commits-since/wyhaines/opentelemetry-instrumentation.cr/latest?style=for-the-badge" alt="GitHub commits since latest release (by SemVer)" /></p>
<h1><a id="opentelemetry-instrumentation" class="anchor" href="#opentelemetry-instrumentation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>opentelemetry-instrumentation</h1>
<p>This package provides both the base functionality needed to build instrumentation for arbitrary classes/libraries, but also ready-made instrumentation for commonly used Crystal libraries.</p>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<ol>
<li>
<p>Add the dependency to your <code>shard.yml</code>:</p>
<pre><code class="language-yaml">dependencies:
  opentelemetry-instrumentation:
    github: wyhaines/opentelemetry-instrumentation.cr</code></pre>
</li>
<li>
<p>Run <code>shards install</code></p>
</li>
</ol>
<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;opentelemetry-instrumentation.cr&quot;</span></code></pre>
<p>Requiring the top level library will attempt to instrument, via a <code>macro finished</code> block, every component within your project for which there exists instrumentation. Each instrumentation package attempts to determine whether it is safe to install before doing so, by validating that required components are installed, and that their versions are compatible.</p>
<p>The reason for running the autoinstrumentation within a <code>finished</code> block is to ensure that all other classes have been loaded prior to loading the instrumentation. However, the structure of some softare and frameworks (such as <a href="https://luckyframework.org/">https://luckyframework.org/</a>) prevent this from working properly. If it appears that instrumentation has not been installed, you can check what instruments have been installed by examining the data returned from <code>OpenTelemetry::Instrumentation::Registry.instruments</code>. It may look like this:</p>
<pre><code class="language-crystal">[<span class="t">OpenTelemetry</span><span class="t">::</span><span class="t">Instrumentation</span><span class="t">::</span><span class="t">CrystalDB</span>,
<span class="t">OpenTelemetry</span><span class="t">::</span><span class="t">Instrumentation</span><span class="t">::</span><span class="t">CrystalHttpServer</span>,
<span class="t">OpenTelemetry</span><span class="t">::</span><span class="t">Instrumentation</span><span class="t">::</span><span class="t">CrystalLog</span>]
</code></pre>
<p>If the array is empty, then no instrumentation was installed. You can require instrumentation manually by requiring the relevant file. For instance, to manually install the DB instrumentation (assuming that DB has been previously required):</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;opentelemetry-instrumentation/src/instrumentation/crystal/db&quot;</span></code></pre>
<h2><a id="documentation" class="anchor" href="#documentation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Documentation</h2>
<p>The generated docs can all be found here:</p>
<p><a href="https://wyhaines.github.io/opentelemetry-instrumentation.cr/">https://wyhaines.github.io/opentelemetry-instrumentation.cr/</a></p>
<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>
<ol>
<li>Fork it (<a href="https://github.com/wyhaines/opentelemetry-instrumentation.cr/fork">https://github.com/wyhaines/opentelemetry-instrumentation.cr/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/wyhaines">Kirk Haines</a> - creator and maintainer</li>
</ul>
<p><img src="https://img.shields.io/github/languages/code-size/wyhaines/opentelemetry-instrumentation.cr?style=for-the-badge" alt="GitHub code size in bytes" />
<img src="https://img.shields.io/github/issues/wyhaines/opentelemetry-instrumentation.cr?style=for-the-badge" alt="GitHub issues" /></p>
</div>
</body>
</html>
